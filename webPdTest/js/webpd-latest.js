!function(e,t,n){"use strict";function i(e){e&&(e.setTargetAtTime||(e.setTargetAtTime=e.setTargetValueAtTime))}window.hasOwnProperty("webkitAudioContext")&&!window.hasOwnProperty("AudioContext")&&(window.AudioContext=webkitAudioContext,AudioContext.prototype.hasOwnProperty("createGain")||(AudioContext.prototype.createGain=AudioContext.prototype.createGainNode),AudioContext.prototype.hasOwnProperty("createDelay")||(AudioContext.prototype.createDelay=AudioContext.prototype.createDelayNode),AudioContext.prototype.hasOwnProperty("createScriptProcessor")||(AudioContext.prototype.createScriptProcessor=AudioContext.prototype.createJavaScriptNode),AudioContext.prototype.hasOwnProperty("createPeriodicWave")||(AudioContext.prototype.createPeriodicWave=AudioContext.prototype.createWaveTable),AudioContext.prototype.internal_createGain=AudioContext.prototype.createGain,AudioContext.prototype.createGain=function(){var e=this.internal_createGain();return i(e.gain),e},AudioContext.prototype.internal_createDelay=AudioContext.prototype.createDelay,AudioContext.prototype.createDelay=function(e){var t=e?this.internal_createDelay(e):this.internal_createDelay();return i(t.delayTime),t},AudioContext.prototype.internal_createBufferSource=AudioContext.prototype.createBufferSource,AudioContext.prototype.createBufferSource=function(){var e=this.internal_createBufferSource();return e.start?(e.internal_start=e.start,e.start=function(t,n,i){"undefined"!=typeof i?e.internal_start(t||0,n,i):e.internal_start(t||0,n||0)}):e.start=function(e,t,n){t||n?this.noteGrainOn(e||0,t,n):this.noteOn(e||0)},e.stop?(e.internal_stop=e.stop,e.stop=function(t){e.internal_stop(t||0)}):e.stop=function(e){this.noteOff(e||0)},i(e.playbackRate),e},AudioContext.prototype.internal_createDynamicsCompressor=AudioContext.prototype.createDynamicsCompressor,AudioContext.prototype.createDynamicsCompressor=function(){var e=this.internal_createDynamicsCompressor();return i(e.threshold),i(e.knee),i(e.ratio),i(e.reduction),i(e.attack),i(e.release),e},AudioContext.prototype.internal_createBiquadFilter=AudioContext.prototype.createBiquadFilter,AudioContext.prototype.createBiquadFilter=function(){var e=this.internal_createBiquadFilter();return i(e.frequency),i(e.detune),i(e.Q),i(e.gain),e},AudioContext.prototype.hasOwnProperty("createOscillator")&&(AudioContext.prototype.internal_createOscillator=AudioContext.prototype.createOscillator,AudioContext.prototype.createOscillator=function(){var e=this.internal_createOscillator();return e.start?(e.internal_start=e.start,e.start=function(t){e.internal_start(t||0)}):e.start=function(e){this.noteOn(e||0)},e.stop?(e.internal_stop=e.stop,e.stop=function(t){e.internal_stop(t||0)}):e.stop=function(e){this.noteOff(e||0)},e.setPeriodicWave||(e.setPeriodicWave=e.setWaveTable),i(e.frequency),i(e.detune),e})),window.hasOwnProperty("webkitOfflineAudioContext")&&!window.hasOwnProperty("OfflineAudioContext")&&(window.OfflineAudioContext=webkitOfflineAudioContext)}(window),function e(t,n,i){function r(s,a){if(!n[s]){if(!t[s]){var c="function"==typeof require&&require;if(!a&&c)return c(s,!0);if(o)return o(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var l=n[s]={exports:{}};t[s][0].call(l.exports,function(e){var n=t[s][1][e];return r(n?n:e)},l,l.exports,e,t,n,i)}return n[s].exports}for(var o="function"==typeof require&&require,s=0;s<i.length;s++)r(i[s]);return r}({1:[function(e,t,n){var i=e("underscore"),r=e("pd-fileutils.parser"),o=e("web-audio-boilerplate"),s=e("./lib/core/Patch"),a=e("./lib/core/Abstraction"),c=e("./lib/core/PdObject"),u=e("./lib/core/mixins"),l=e("./lib/core/errors"),d=e("./lib/waa/portlets"),f=e("./lib/waa/interfaces"),h=e("./lib/global"),p=e("./lib/core/interfaces"),m=i.extend({},u.UniqueIdsMixin);e("./lib/index").declareObjects(h.library);var v=t.exports={start:function(e){e=e||{},h.isStarted||("undefined"!=typeof AudioContext?(h.audio=e.audio||new f.Audio({channelCount:h.settings.channelCount,audioContext:e.audioContext}),h.clock=e.clock||new f.Clock({audioContext:h.audio.context,waaClock:e.waaClock}),h.midi=e.midi||new f.Midi):(h.audio=e.audio||p.Audio,h.clock=e.clock||p.Clock,h.midi=e.midi||p.Midi),h.storage=e.storage?e.storage:"undefined"!=typeof window?new f.Storage:p.Storage,h.midi.onMessage(function(e){h.emitter.emit("midiMessage",e)}),h.audio.start(),i.values(h.patches).forEach(function(e){e.start()}),h.isStarted=!0)},stop:function(){h.isStarted&&(h.isStarted=!1,i.values(h.patches).forEach(function(e){e.stop()}),h.audio.stop())},isStarted:function(){return h.isStarted},getAudio:function(){return h.audio},getMidi:function(){return h.midi},send:function(e,t){h.emitter.emit("msg:"+e,t)},receive:function(e,t){h.emitter.on("msg:"+e,t)},registerAbstraction:function(e,t){i.isString(t)&&(t=r.parse(t));var n=function(e,n,i){var e=new a(e,n,i);return e.patchId=m._generateId(),v._preparePatch(e,t),e};n.prototype=a.prototype,this.registerExternal(e,n)},registerExternal:function(e,t){h.library[e]=t},createPatch:function(){var e=this._createPatch();return h.isStarted&&e.start(),e},destroyPatch:function(e){e.stop(),e.destroy(),delete h.patches[e.patchId]},loadPatch:function(e){var t=this._createPatch();return i.isString(e)&&(e=this.parsePatch(e)),this._preparePatch(t,e),h.isStarted&&t.start(),t},parsePatch:function(e){return i.isString(e)&&(e=r.parse(e)),e},getSupportedFormats:function(e){var t=new AudioContext;o.getSupportedFormats(t,e)},startOnClick:function(e,t,n){o.getAudioContextOnClick(e,function(e,i){return e?console.error(e):(n=n||{},n.audioContext=i,v.start(n),void(t&&t()))})},_createPatch:function(){var e=new s;return e.patchId=m._generateId(),h.patches[e.patchId]=e,e},_preparePatch:function(e,t){var n={},i=[];if(t.nodes.forEach(function(t){var r,o=t.proto;try{r=e._createObject(o,t.args||[])}catch(s){if(s instanceof l.UnknownObjectError)return i.push([s.message,s]);throw s}"array"==r.type&&t.data&&r.setData(new Float32Array(t.data),!0),("pd"===o||"graph"===o)&&v._preparePatch(r,t.subpatch),n[t.id]=r}),t.connections.forEach(function(e){var t=n[e.source.id],r=n[e.sink.id];if(!t||!r){var o="invalid connection "+e.source.id+".* -> "+e.sink.id+".*";return i.push([o,new Error("unknown portlet")])}try{t.o(e.source.port).connect(r.i(e.sink.port))}catch(s){if(s instanceof l.InvalidPortletError){var o="invalid connection "+e.source.id+"."+e.source.port+" -> "+e.sink.id+"."+e.sink.port;return i.push([o,s])}}}),e.patchData=t,i.length)throw new l.PatchLoadError(i)},core:{PdObject:c,portlets:d,errors:l},_glob:h};"undefined"!=typeof window&&(window.Pd=v)},{"./lib/core/Abstraction":3,"./lib/core/Patch":5,"./lib/core/PdObject":6,"./lib/core/errors":7,"./lib/core/interfaces":8,"./lib/core/mixins":9,"./lib/global":12,"./lib/index":14,"./lib/waa/interfaces":17,"./lib/waa/portlets":18,"pd-fileutils.parser":21,underscore:25,"web-audio-boilerplate":39}],2:[function(e,t,n){var i=(e("events").EventEmitter,e("underscore")),r=e("./core/utils"),o=e("./core/mixins"),s=e("./core/PdObject"),a=(e("./core/Patch"),e("./global")),c=e("./waa/portlets");n.declareObjects=function(e){var t=s.extend({inletDefs:[c.Inlet.extend({message:function(e){this.obj._onMessageReceived(e)}})],outletDefs:[c.Outlet],init:function(e,t,n,i,r){if(this._eventReceiver=new o.EventReceiver,this.value=n?r:i,e&&"-"!==e&&"empty"!==e&&(this.receiveName=e,this._onMessageReceived&&(this._onMessageReceived=this._onMessageReceived.bind(this),this._eventReceiver.on(a.emitter,"msg:"+this.receiveName,this._onMessageReceived))),t&&"-"!==t&&"empty"!==t&&(this.sendName=t),n&&this.patch){var s=this;this._onPatchStarted=function(){s._sendMessage([s.value])},this._eventReceiver.on(this.patch,"started",this._onPatchStarted)}},destroy:function(){this._eventReceiver.destroy()},_sendMessage:function(e){this.o(0).message(e),this.sendName&&a.emitter.emit("msg:"+this.sendName,e)}});e.symbolatom=t.extend({type:"symbolatom",init:function(e){var n=(e[0]||void 0,e[1]||void 0,e[2]),i=e[3];t.prototype.init.apply(this,[n,i,0,"symbol",0])},_onMessageReceived:function(e){var t=e[0];return"bang"===t||i.isNumber(t)||"symbol"===t?(i.isNumber(t)?this.value="float":"symbol"===t&&(this.value=e[1]),void this._sendMessage(r.timeTag(["symbol",this.value],e))):console.error("invalid "+t)}});var n=t.extend({init:function(e,n,r,o,s,a){this._limitInput=function(e){return i.isNumber(s)&&(e=Math.min(e,s)),i.isNumber(o)&&(e=Math.max(e,o)),e},t.prototype.init.apply(this,[n,r,e,0,a])},_onMessageReceived:function(e){var t=e[0];return"bang"===t||i.isNumber(t)?(i.isNumber(t)&&(this.value=t),void this._sendMessage(r.timeTag([this._limitInput(this.value)],e))):console.error("invalid "+t)}});e.floatatom=n.extend({type:"floatatom",init:function(e){var t=e[0]||void 0,i=e[1]||void 0,r=e[2],o=e[3];n.prototype.init.apply(this,[0,r,o,t,i,0])}}),e.nbx=n.extend({type:"nbx",init:function(e){var t=e[0]||void 0,i=e[1]||void 0,r=e[2]||0,o=e[3],s=e[4],a=e[5]||0;n.prototype.init.apply(this,[r,o,s,t,i,a])}}),e.bng=t.extend({type:"bng",init:function(e){var n=e[0]||0,i=e[1],r=e[2];t.prototype.init.apply(this,[i,r,n,"bang","bang"])},_onMessageReceived:function(e){this._sendMessage(r.timeTag(["bang"],e))}}),e.tgl=t.extend({type:"tgl",init:function(e){var n=e[0]||0,r=e[1],o=e[2],s=e[3]||0,a=i.isNumber(e[4])?e[4]:1;t.prototype.init.apply(this,[r,o,n,0,s]),this.nonZeroValue=a},_onMessageReceived:function(e){var t=e[0];if("bang"===t)this.value=0===this.value?this.nonZeroValue:0,this._sendMessage(r.timeTag([this.value],e));else{if(!i.isNumber(t))return console.error("invalid message received "+e);this.value=0===t?0:this.nonZeroValue,this._sendMessage(r.timeTag([t],e))}}});var u=n.extend({init:function(e){var t=e[0]||0,r=i.isNumber(e[1])?e[1]:127,o=e[2]||0,s=e[3],a=e[4],c=e[5]||0;n.prototype.init.apply(this,[o,s,a,t,r,c])}});e.hsl=u.extend({type:"hsl"}),e.vsl=u.extend({type:"vsl"});var l=t.extend({init:function(e){var n=(e[0],e[1]),r=i.isNumber(e[2])?e[2]:8,o=e[3],s=e[4],a=e[5]||0;this._limitInput=function(e){return Math.floor(Math.min(Math.max(e,0),r-1))},t.prototype.init.apply(this,[o,s,n,0,a])},_onMessageReceived:function(e){var t=e[0];return"bang"===t||i.isNumber(t)?(i.isNumber(t)&&(this.value=t),void this._sendMessage(r.timeTag([this._limitInput(this.value)],e))):console.error("invalid "+t)}});e.hradio=l.extend({type:"hradio"}),e.vradio=l.extend({type:"vradio"}),e.vu=t.extend({init:function(e){var n=e[0];t.prototype.init.apply(this,[n,void 0,0,0,0])},_onMessageReceived:function(e){this._sendMessage(e)}})}},{"./core/Patch":5,"./core/PdObject":6,"./core/mixins":9,"./core/utils":11,"./global":12,"./waa/portlets":18,events:19,underscore:25}],3:[function(e,t,n){var i=e("underscore"),r=e("./Patch"),o=t.exports=function(e,t,n){r.apply(this,arguments)};i.extend(o.prototype,r.prototype,{getPatchRoot:function(){return this}})},{"./Patch":5,underscore:25}],4:[function(e,t,n){var i=e("underscore"),r=(e("util").inherits,e("./errors")),o=(e("./portlets"),e("./utils"),t.exports=function(e,t,n){n=n||[];var i=this;this.id=t,this.patch=e,this.inlets=this.inletDefs.map(function(e,t){return new e(i,t)}),this.outlets=this.outletDefs.map(function(e,t){return new e(i,t)}),this.init(n)});i.extend(o.prototype,{endPoint:!1,doResolveArgs:!1,outletDefs:[],inletDefs:[],init:function(){},start:function(){},stop:function(){},destroy:function(){},i:function(e){if(e<this.inlets.length)return this.inlets[e];throw new r.InvalidPortletError("inlet "+e+" doesn't exist")},o:function(e){if(e<this.outlets.length)return this.outlets[e];throw new r.InvalidPortletError("outlet "+e+" doesn't exist")},startPortlets:function(){this.outlets.forEach(function(e){e.start()}),this.inlets.forEach(function(e){e.start()})},stopPortlets:function(){this.outlets.forEach(function(e){e.stop()}),this.inlets.forEach(function(e){e.stop()})}})},{"./errors":7,"./portlets":10,"./utils":11,underscore:25,util:28}],5:[function(e,t,n){var i=e("underscore"),r=e("events").EventEmitter,o=e("./mixins"),s=e("./utils"),a=e("./BaseNode"),c=e("./errors"),u=e("../global"),l=t.exports=function(){a.apply(this,arguments),this.objects=[],this.endPoints=[],this.patchId=null,this.patchData=null,this.blockSize=u.settings.blockSize};i.extend(l.prototype,a.prototype,o.UniqueIdsMixin,r.prototype,{type:"patch",init:function(e){this.args=e},start:function(){this.startObjects(),this.startPortlets()},stop:function(){this.stopObjects(),this.stopPortlets()},destroy:function(){this.objects.forEach(function(e){e.destroy()})},startObjects:function(){this.objects.forEach(function(e){e.startObjects?e.startObjects():e.start()})},stopObjects:function(){this.objects.forEach(function(e){e.stopObjects?e.stopObjects():e.stop()})},startPortlets:function(){this.objects.forEach(function(e){e.startPortlets()}),this.emit("started")},stopPortlets:function(){this.objects.forEach(function(e){e.stopPortlets()}),this.emit("stopped")},createObject:function(e,t){var n=this._createObject(e,t);return u.isStarted&&(n.start(),n.startPortlets()),n},_createObject:function(e,t){var n;if(t=t||[],!u.library.hasOwnProperty(e))throw new c.UnknownObjectError(e);var i=u.library[e];return i.prototype.doResolveArgs&&(t=this.resolveArgs(t)),n=new i(this,this._generateId(),t),this.objects[n.id]=n,n.endPoint&&this.endPoints.push(n),d(n)&&this.inlets.push(n.inlets[0]),f(n)&&this.outlets.push(n.outlets[0]),n},resolveArgs:function(e){var t,n=e.slice(0),i=this.getPatchRoot().patchId;return t=[i].concat(this.args),e.forEach(function(e,t){"b"===e?n[t]="bang":"f"===e?n[t]="float":"s"===e?n[t]="symbol":"a"===e?n[t]="anything":"l"===e&&(n[t]="list")}),s.getDollarResolver(n)(t)},getPatchRoot:function(){return this.patch?this.patch.getPatchRoot():this}});var d=function(e){return[u.library.inlet,u.library["inlet~"]].some(function(t){return e instanceof t})},f=function(e){return[u.library.outlet,u.library["outlet~"]].some(function(t){return e instanceof t})}},{"../global":12,"./BaseNode":4,"./errors":7,"./mixins":9,"./utils":11,events:19,underscore:25}],6:[function(e,t,n){var i=e("underscore"),r=(e("util").inherits,e("./portlets"),e("./utils")),o=e("./BaseNode"),s=(e("./Patch"),e("../global"),t.exports=function(){o.apply(this,arguments)});s.extend=r.chainExtend,i.extend(s.prototype,o.prototype,{doResolveArgs:!0})},{"../global":12,"./BaseNode":4,"./Patch":5,"./portlets":10,"./utils":11,underscore:25,util:28}],7:[function(e,t,n){var i=e("underscore"),r=n.PatchLoadError=function(e){this.name="PatchLoadError",this.errorList=e,this.message=i.map(e,function(e){return e[0]+"\n	"+e[1].message}).join("\n"),this.stack=(new Error).stack};r.prototype=Object.create(Error.prototype),r.prototype.constructor=r;var o=n.UnknownObjectError=function(e){this.name="UnknownObjectError",this.message="unknown object "+e,this.objectType=e,this.stack=(new Error).stack};o.prototype=Object.create(Error.prototype),o.prototype.constructor=o;var s=n.InvalidPortletError=function(e){this.name="InvalidPortletError",this.message=e,this.stack=(new Error).stack};s.prototype=Object.create(Error.prototype),s.prototype.constructor=s},{underscore:25}],8:[function(e,t,n){n.Clock={time:0,schedule:function(e,t,n){},unschedule:function(e){}},n.Audio={sampleRate:44100,start:function(){},stop:function(){},decode:function(e,t){t(null,e)}},n.Midi={onMessage:function(e){}},n.Storage={get:function(e,t){}}},{}],9:[function(e,t,n){var i=e("events").EventEmitter,r=e("underscore"),o=e("../global");n.NamedMixin={nameIsUnique:!1,setName:function(e){if(!r.isString(e))return console.error("expected ["+this.type+"] name to be a string, got "+e);var t=this.name;this.emit("changing:name",t,e),this.name=e,o.namedObjects.register(this,this.type,e,this.nameIsUnique,t),this.emit("changed:name",t,e)},destroy:function(){o.namedObjects.unregister(this,this.type,this.name)}};var s=n.EventEmitterMixin=r.extend({},i.prototype,{destroy:function(){this.removeAllListeners()}}),a=n.Reference=function(e){this.referencedType=e,this._onNewObject=null,this._onChangedName=null,this.resolved=null,this._eventName="namedObjects:registered:"+this.referencedType,this._eventReceiver=new c};r.extend(a.prototype,s,{set:function(e){var t=this,n=o.namedObjects.get(this.referencedType,e)[0];this.name=e,this._stopListening(),n?this._setResolved(n):(this._setResolved(null),this._onNewObject=function(n){n.name===e&&(t._stopListening(),t._setResolved(n))},this._eventReceiver.on(o.emitter,this._eventName,this._onNewObject))},destroy:function(){this._eventReceiver.destroy(),s.destroy.apply(this)},_setResolved:function(e){var t=this,n=this.resolved;this.resolved=e,n&&n.removeListener("changing:name",t._onChangedName),e&&(this._onChangedName=function(){t._setResolved(null)},this._eventReceiver.on(e,"changing:name",this._onChangedName)),this.emit("changed",e,n)},_stopListening:function(){this._onNewObject&&(this._eventReceiver.removeListener(o.emitter,this._eventName,this._onNewObject),this._onNewObject=null)}}),n.UniqueIdsMixin={_generateId:function(){return this._idCounter++,this._idCounter},_idCounter:-1};var c=n.EventReceiver=function(){this._handlers=[]};r.extend(c.prototype,{addListener:function(e,t,n){this._handlers.push([e,t,n]),e.addListener(t,n)},once:function(e,t,n){var i=[e,t,n];this._handlers.push(i),e.once(t,n)},removeListener:function(e,t,n){this._handlers=r.reject(this._handlers,function(i){var r=i[0]===e&&i[1]===t&&i[2]===n;return r&&e.removeListener(t,n),r})},destroy:function(){this._handlers.forEach(function(e){e[0].removeListener(e[1],e[2])}),this._handlers=[]}}),c.prototype.on=c.prototype.addListener},{"../global":12,events:19,underscore:25}],10:[function(e,t,n){var i=e("underscore"),r=e("./utils"),o=e("./errors"),s=n.Portlet=function(e,t){this.obj=e,this.id=t,this.connections=[],this.init()};i.extend(s.prototype,{crossPatch:!1,init:function(){},start:function(){},stop:function(){},message:function(e){},connection:function(e){},disconnection:function(e){},connect:function(e){if(-1!==this.connections.indexOf(e))return!1;if(!this.crossPatch&&!e.crossPatch&&this.obj.patch!==e.obj.patch)throw new Error("cannot connect objects that belong to different patches");return this.connections.push(e),e.connect(this),this.connection(e),!0},disconnect:function(e){var t=this.connections.indexOf(e);return-1===t?!1:(this.connections.splice(t,1),e.disconnect(this),this.disconnection(e),!0)}}),s.extend=r.chainExtend;var a=(n.Inlet=s.extend({}),n.Outlet=s.extend({}),s.extend({portletType:null,connect:function(){throw new o.InvalidPortletError(this.portletType+" "+this.id+" is not implemented in WebPd yet")},disconnect:function(){throw new o.InvalidPortletError(this.portletType+" "+this.id+" is not implemented in WebPd yet")}}));n.UnimplementedInlet=a.extend({portletType:"inlet"}),n.UnimplementedOutlet=a.extend({portletType:"outlet"})},{"./errors":7,"./utils":11,underscore:25}],11:[function(e,t,n){var i=e("underscore"),r=e("../global"),o=/\$(\d+)/,s=/\$(\d+)/g;n.getDollarResolver=function(e){e=e.slice(0);var t=function(e,t){if(t>=e.length||0>t)throw new Error("$"+(t+1)+": argument number out of range");return e[t]},n=e.map(function(e){var n=o.exec(e);return n&&n[0]===e?function(e){var i=parseInt(n[1],10);return function(e){return t(e,i)}}(e):n?function(e){for(var n,i=[];n=s.exec(e);)i.push([n[0],parseInt(n[1],10)]);return function(n){var r=e.substr(0);return i.forEach(function(e){r=r.replace(e[0],t(n,e[1]))}),r}}(e):function(e){return function(){return e}}(e)});return function(e){return n.map(function(t,n){return t(e)})}},n.chainExtend=function(){var e=Array.prototype.slice.call(arguments,0),t=this,n=function(){t.apply(this,arguments)};return n.prototype=new t,i.extend.apply(this,[n.prototype,t.prototype].concat(e)),n.extend=this.extend,n},n.timeTag=function(e,t){return t?(e.timeTag=i.isNumber(t)?t:t.timeTag,e):e},n.getTimeTag=function(e){return e&&e.timeTag||r.clock&&r.clock.time||0}},{"../global":12,underscore:25}],12:[function(e,t,n){var i=e("underscore"),r=e("events").EventEmitter;n.settings={blockSize:16384,channelCount:2},n.isStarted=!1;var o=n.emitter=new r;o.emit=function(e){if(!i.contains(["midiMessage"],e)&&0!==e.indexOf("msg:")&&0!==e.indexOf("namedObjects:registered")&&0!==e.indexOf("namedObjects:unregistered"))throw new Error("unknown event : "+e);r.prototype.emit.apply(this,arguments)},n.library={},n.patches={},n.audio=null,n.midi=null,n.clock=null,n.storage=null,n.namedObjects={register:function(e,t,i,r,o){var s,a;if(this._store[t]=s=this._store[t]||{},s[i]=a=s[i]||[],-1===a.indexOf(e)){if(r&&a.length>0)throw new Error("there is already a "+t+' with name "'+i+'"');a.push(e)}o&&(a=s[o],a.splice(a.indexOf(e),1)),n.emitter.emit("namedObjects:registered:"+t,e)},unregister:function(e,t,i){var r,o=this._store[t],s=o?o[i]:null;s&&(r=s.indexOf(e),-1!==r&&(s.splice(r,1),n.emitter.emit("namedObjects:unregistered:"+t,e)))},get:function(e,t){return(this._store[e]||{})[t]||[]},reset:function(){this._store={}},_store:{}}},{events:19,underscore:25}],13:[function(e,t,n){var i=e("underscore"),r=e("./core/utils"),o=e("./core/mixins"),s=e("./core/PdObject"),a=e("./core/Patch"),c=e("./global"),u=e("./waa/portlets");n.declareObjects=function(e){e.receive=e.r=s.extend(o.NamedMixin,o.EventEmitterMixin,{type:"receive",outletDefs:[u.Outlet],abbreviations:["r"],init:function(e){var t=e[0],n=this;this._eventReceiver=new o.EventReceiver,this._onMessageReceived=this._onMessageReceived.bind(this),this._eventReceiver.on(this,"changed:name",function(e,t){e&&n._eventReceiver.removeListener(c.emitter,"msg:"+e,n._onMessageReceived),n._eventReceiver.on(c.emitter,"msg:"+t,n._onMessageReceived)}),this.setName(t)},destroy:function(){o.NamedMixin.destroy.apply(this,arguments),this._eventReceiver.destroy(),o.EventEmitterMixin.destroy.apply(this,arguments)},_onMessageReceived:function(e){this.o(0).message(e)}}),e.send=e.s=s.extend(o.NamedMixin,o.EventEmitterMixin,{type:"send",inletDefs:[u.Inlet.extend({message:function(e){c.emitter.emit("msg:"+this.obj.name,e)}})],abbreviations:["s"],init:function(e){this.setName(e[0])},destroy:function(){o.NamedMixin.destroy.apply(this,arguments),o.EventEmitterMixin.destroy.apply(this,arguments)}}),e.msg=s.extend({type:"msg",doResolveArgs:!1,inletDefs:[u.Inlet.extend({message:function(e){var t=e.timeTag;e=e.slice(0),e.unshift(0);for(var n=0;n<this.obj.resolvers.length;n++){var i=this.obj.resolvers[n];this.obj.outlets[0].message(r.timeTag(i(e),t))}}})],outletDefs:[u.Outlet],init:function(e){this.createResolvers(e)},createResolvers:function(e){for(var t=[[]],n=0;n<e.length;n++){var i=e[n];","==i?t.push([]):t[t.length-1].push(i)}0==t[t.length-1].length&&t.pop(),this.resolvers=[];for(var n in t){var o=t[n];this.resolvers.push(r.getDollarResolver(o))}}}),e.print=s.extend({type:"print",inletDefs:[u.Inlet.extend({message:function(e){console.log(this.obj.prefix?[this.obj.prefix].concat(e):e)}})],init:function(e){this.prefix=e[0]||"print"}}),e.text=s.extend({type:"text",init:function(e){this.text=e[0]}}),e.loadbang=s.extend({type:"loadbang",outletDefs:[u.Outlet],init:function(){var e=this;this._eventReceiver=new o.EventReceiver,this._onPatchStarted=function(){e.o(0).message(["bang"])},this._eventReceiver.on(this.patch,"started",this._onPatchStarted)},destroy:function(){this._eventReceiver.destroy()}});var t=s.extend({inletDefs:[u.Inlet.extend({message:function(e){var t=e[0];"bang"!==t&&this.obj.setVal(t),this.obj.o(0).message(r.timeTag([this.obj.val],e))}}),u.Inlet.extend({message:function(e){var t=e[0];this.obj.setVal(t)}})],outletDefs:[u.Outlet],init:function(e){var t=e[0];this.setVal(t||0)},setVal:function(e){this.val=e}});e["float"]=e.f=t.extend({type:"float",setVal:function(e){return i.isNumber(e)?void(this.val=e):console.error("invalid [float] value "+e)}}),e["int"]=e.i=t.extend({type:"int",setVal:function(e){return i.isNumber(e)?void(this.val=Math.floor(e)):console.error("invalid [int] value "+e)}});var n=s.extend({inletDefs:[u.Inlet.extend({message:function(e){var t=e[0];i.isNumber(t)?this.obj.valLeft=t:"bang"!==t&&console.error("invalid message : "+e),this.obj.o(0).message(r.timeTag([this.obj.compute()],e))}}),u.Inlet.extend({message:function(e){var t=e[0];return i.isNumber(t)?void(this.obj.valRight=t):console.error("invalid operand for ["+this.obj.type+"] "+t)}})],outletDefs:[u.Outlet],init:function(e){this.valRight=e[0]||0,this.valLeft=0},compute:function(){}});e["+"]=n.extend({type:"+",compute:function(){return this.valLeft+this.valRight}}),e["-"]=n.extend({type:"-",compute:function(){return this.valLeft-this.valRight}}),e["*"]=n.extend({type:"*",compute:function(){return this.valLeft*this.valRight}}),e["/"]=n.extend({type:"/",compute:function(){return 0==this.valRight?0:this.valLeft/this.valRight}}),e.min=n.extend({type:"min",compute:function(){return Math.min(this.valLeft,this.valRight)}}),e.max=n.extend({type:"max",compute:function(){return Math.max(this.valLeft,this.valRight)}}),e.mod=e["%"]=n.extend({type:"mod",compute:function(){return this.valRight<=0?0:this.valLeft<0?this.valRight+this.valLeft%this.valRight:this.valLeft%this.valRight}}),e.pow=n.extend({type:"pow",compute:function(){return Math.pow(this.valLeft,this.valRight)}});var l=s.extend({inletDefs:[u.Inlet.extend({message:function(e){var t=e[0];this.obj.checkInput(t),this.obj.o(0).message(r.timeTag([this.obj.compute(t)],e))}})],outletDefs:[u.Outlet],checkInput:function(e){},compute:function(){}}),d=l.extend({checkInput:function(e){return i.isNumber(e)?void 0:console.error("invalid ["+this.type+"] value "+e)}});e.cos=d.extend({type:"cos",compute:function(e){return Math.cos(e)}}),e.sin=d.extend({type:"sin",compute:function(e){return Math.sin(e)}}),e.tan=d.extend({type:"tan",compute:function(e){return Math.tan(e)}}),e.atan2=n.extend({type:"atan2",compute:function(){return Math.atan2(this.valRight,this.valLeft)}}),e.atan=d.extend({type:"atan",compute:function(e){return Math.atan(e)}}),e.exp=d.extend({type:"exp",compute:function(e){return Math.exp(e)}}),e.log=d.extend({type:"log",compute:function(e){return Math.log(e)}}),e.abs=d.extend({type:"abs",compute:function(e){return Math.abs(e)}}),e.sqrt=d.extend({type:"sqrt",compute:function(e){return Math.sqrt(e)}}),e.wrap=d.extend({type:"wrap",compute:function(e){return e-Math.floor(e)}}),e.mtof=d.extend({type:"mtof",maxMidiNote:8.17579891564*Math.exp(86.585635235),compute:function(e){var t=0;return i.isNumber(e)?t=-1500>=e?0:e>1499?this.maxMidiNote:8.17579891564*Math.exp(.057762265*e):console.error("invalid [mtof] value "+e)}}),e.ftom=d.extend({type:"ftom",compute:function(e){return i.isNumber(e)?0>=e?-1500:17.312340491*Math.log(.122312206*e):console.error("invalid [ftom] value "+e)}}),e.rmstodb=d.extend({type:"rmstodb",compute:function(e){return 0>=e?0:20*Math.log(e)/Math.LN10+100}}),e.dbtorms=d.extend({type:"dbtorms",compute:function(e){return 0>=e?0:Math.exp(Math.LN10*(e-100)/20)}}),e.powtodb=d.extend({type:"powtodb",compute:function(e){return 0>=e?0:10*Math.log(e)/Math.LN10+100}}),e.dbtopow=d.extend({type:"dbtopow",compute:function(e){return 0>=e?0:Math.exp(Math.LN10*(e-100)/10)}}),e["samplerate~"]=l.extend({type:"samplerate~",compute:function(){return c.audio.sampleRate}}),e.spigot=s.extend({type:"spigot",inletDefs:[u.Inlet.extend({message:function(e){this.obj.passing&&this.obj.o(0).message(e)}}),u.Inlet.extend({message:function(e){var t=e[0];this.obj.setPassing(t)}})],outletDefs:[u.Outlet],init:function(e){var t=e[0];this.setPassing(t||0)},setPassing:function(e){return i.isNumber(e)?void(this.passing=Boolean(e)):console.error("invalid [spigot] value "+e)}}),e.trigger=e.t=s.extend({type:"trigger",inletDefs:[u.Inlet.extend({message:function(e){var t,n,o;for(t=this.obj.filters.length-1;t>=0;t--)if(n=this.obj.filters[t],"bang"===n)this.obj.o(t).message(r.timeTag(["bang"],e));else if("list"===n||"anything"===n)this.obj.o(t).message(e);else if("float"===n||i.isNumber(n))o=e[0],this.obj.o(t).message(i.isNumber(o)?r.timeTag([o],e):r.timeTag([0],e));else if("symbol"===n)if(o=e[0],"bang"===o)this.obj.o(t).message(r.timeTag(["symbol"],e));else if(i.isNumber(o))this.obj.o(t).message(r.timeTag(["float"],e));else{if(!i.isString(o))throw new Error("Got unexpected input "+e);this.obj.o(t).message(r.timeTag([o],e))}else this.obj.o(t).message(r.timeTag(["bang"],e))}})],init:function(e){var t,n;for(0===e.length&&(e=["bang","bang"]),t=0,n=e.length;n>t;t++)this.outlets.push(new u.Outlet(this,t));this.filters=e}});var f=u.Inlet.extend({message:function(e){var t=e[0];"bang"!==t&&(this.obj.memory[0]=t),this.obj.o(0).message(r.timeTag(this.obj.memory.slice(0),e))}}),h=u.Inlet.extend({message:function(e){var t=e[0];this.obj.memory[this.id]=t}});e.pack=s.extend({type:"pack",outletDefs:[u.Outlet],init:function(e){var t,n=e.length;for(0===n&&(e=["float","float"]),n=e.length,this.filters=e,this.memory=new Array(n),t=0;n>t;t++)this.inlets[t]=0===t?new f(this,t):new h(this,t),this.memory[t]="float"===e[t]?0:"symbol"===e[t]?"symbol":e[t]}}),e.select=e.sel=s.extend({type:"select",inletDefs:[u.Inlet.extend({message:function(e){var t,n=e[0];-1!==(t=this.obj.filters.indexOf(n))?this.obj.o(t).message(r.timeTag(["bang"],e)):this.obj.outlets.slice(-1)[0].message(r.timeTag([n],e))}}),u.Inlet.extend({message:function(e){this.obj.filters.length<=1&&(this.obj.filters=e)}})],init:function(e){var t,n;for(0===e.length&&(e=[0]),e.length>1&&this.inlets.pop(),t=0,n=e.length;n>t;t++)this.outlets[t]=new u.Outlet(this,t);this.outlets[t]=new u.Outlet(this,t),this.filters=e}}),e.moses=s.extend({type:"moses",inletDefs:[u.Inlet.extend({message:function(e){var t=e[0];return i.isNumber(t)?void(t<this.obj.val?this.obj.o(0).message(r.timeTag([t],e)):this.obj.o(1).message(r.timeTag([t],e))):console.error("invalid [moses] value "+t)}}),u.Inlet.extend({message:function(e){var t=e[0];this.obj.setVal(t)}})],outletDefs:[u.Outlet,u.Outlet],init:function(e){var t=e[0];this.setVal(t||0)},setVal:function(e){return i.isNumber(e)?void(this.val=e):console.error("invalid [moses] value "+e)}}),e.clip=s.extend({type:"clip",inletDefs:[u.Inlet.extend({message:function(e){var t=e[0];return i.isNumber(t)?void this.obj.o(0).message(t<this.obj.min?r.timeTag([this.obj.min],e):t>this.obj.max?r.timeTag([this.obj.max],e):r.timeTag([t],e)):console.error("invalid [clip] value "+t)}}),u.Inlet.extend({message:function(e){var t=e[0];this.obj.setMin(t)}}),u.Inlet.extend({message:function(e){var t=e[0];this.obj.setMax(t)}})],outletDefs:[u.Outlet],init:function(e){this.setMin(e[0]||0),this.setMax(e[1]||0)},setMin:function(e){return i.isNumber(e)?void(this.min=e):console.error("invalid [clip] min value "+e)},setMax:function(e){return i.isNumber(e)?void(this.max=e):console.error("invalid [clip] max value "+e)}}),e.swap=s.extend({type:"swap",inletDefs:[u.Inlet.extend({message:function(e){var t=e[0];return i.isNumber(t)?(this.obj.o(1).message(r.timeTag([t],e)),void this.obj.o(0).message(r.timeTag([this.obj.val],e))):console.error("invalid [swap] value "+t)}}),u.Inlet.extend({message:function(e){var t=e[0];this.obj.setVal(t)}})],outletDefs:[u.Outlet,u.Outlet],init:function(e){var t=e[0];this.setVal(t||0)},setVal:function(e){return i.isNumber(e)?void(this.val=e):console.error("invalid [swap] value "+e)}}),e.until=s.extend({type:"until",inletDefs:[u.Inlet.extend({message:function(e){var t=e[0];if("bang"===t)this.obj._startLoop(e.timeTag);else{if(!i.isNumber(t))return console.error("invalid [until] value "+t);this.obj._startLoop(e.timeTag,t)}}}),u.Inlet.extend({message:function(e){var t=e[0];return"bang"!==t?console.error("invalid command for [until] "+t):void this.obj._stopLoop()}})],outletDefs:[u.Outlet],init:function(){this._looping=!1},_startLoop:function(e,t){this._looping=!0;var n=this,o=0,s=function(){n.o(0).message(r.timeTag(["bang"],e))};if(i.isNumber(t))for(;this._looping&&t>o;)s(),o++;else for(;this._looping;)s();this._looping=!1},_stopLoop:function(){this._looping=!1}}),e.random=s.extend({type:"random",inletDefs:[u.Inlet.extend({message:function(e){var t=e[0];"bang"===t&&this.obj.o(0).message(r.timeTag([Math.floor(Math.random()*this.obj.max)],e))}}),u.Inlet.extend({message:function(e){var t=e[0];this.obj.setMax(t);
